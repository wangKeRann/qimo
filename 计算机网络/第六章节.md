# 第六章 传输层

## 6.1 传输控制协议(TCP)

### 6.1.1 TCP连接管理

#### 三次握手
- 建立连接的过程
- 确保双方通信能力
- 防止历史连接请求

#### 初始序列号
- 随机生成
- 防止序列号预测攻击
- 确保数据包顺序

#### TCP连接释放
- 双向释放机制
- 确保数据完整性
- 优雅关闭连接

### 6.1.2 TCP数据段格式
- 端口号：源端口和目的端口
- 序列号：标识数据字节流
- 确认号：期望收到的下一个字节序号
- 窗口尺寸：流量控制
- 控制位：SYN、ACK、FIN等
- 校验和：错误检测

### 6.1.3 可靠传输保证

#### 肯定确认重传
- 发送方等待确认
- 超时重传机制
- 确认号机制

#### 滑动窗口
- 流量控制
- 提高传输效率
- 避免接收方缓冲区溢出

#### 拥塞控制
- 慢启动
- 快速重传
- 快速恢复

### 6.1.4 TCP优化

#### 发送方优化
- Nagle算法
  - 减少小数据包
  - 提高网络利用率

#### 接收方优化
- Clark解决方案
  - 避免糊涂窗口综合征
  - 优化接收缓冲区

### 6.1.5 TCP定时器
- 重传定时器：处理丢包
- 持续定时器：处理零窗口
- 保活定时器：检测连接状态

## 6.2 用户数据报协议(UDP)

### 6.2.1 特点
- 无连接
- 不可靠
- 简洁高效
- 实时性好

### 6.2.2 UDP数据段格式
- 端口号
- 长度
- 校验和（可选）

### 6.2.3 典型应用
- 远程调用
- 实时传输协议
- 流媒体传输

## 6.3 新型传输协议

### 6.3.1 QUIC协议
- 基于UDP
- 多流复用
- 改进的连接管理
- 更好的性能

### 6.3.2 基本概念
- 端到端通信
- 通信五元组
- 端口号复用/分用
